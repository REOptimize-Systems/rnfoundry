function [fq, Bq, Pq] = m19corelossdata(dointerp)
% returns table of losses per kg in M-19 Steel laminations at a number of
% frequencies and field strengths in Tesla
%
% Syntax
%
% [fq, Bq, Pq] = m19corelossdata()
% [fq, Bq, Pq] = m19corelossdata(dointerp)
%
% 

    if nargin < 1
        dointerp = true;
    end
    
    m19density = 7500; % kg / m^3
    freqs = [50,60,100,150,200,300,400,600,1000,1500,2000;];
    tesla = [0.100000000000000;0.200000000000000;0.400000000000000;0.700000000000000;1;1.20000000000000;1.30000000000000;1.40000000000000;1.50000000000000;1.55000000000000;1.60000000000000;1.65000000000000;1.70000000000000;1.80000000000000;];
    lossperkg = [0.0176000000000000,0.0198000000000000,0.0375000000000000,0.0639000000000000,0.0926000000000000,0.163000000000000,0.247000000000000,0.452000000000000,1.02000000000000,1.98000000000000,3.20000000000000;0.0683000000000000,0.0860000000000000,0.159000000000000,0.262000000000000,0.381000000000000,0.661000000000000,0.994000000000000,1.79000000000000,3.94000000000000,7.43000000000000,11.7000000000000;0.240000000000000,0.295000000000000,0.555000000000000,0.934000000000000,1.37000000000000,2.39000000000000,3.60000000000000,6.52000000000000,14,26.1000000000000,40.8000000000000;0.602000000000000,0.749000000000000,1.43000000000000,2.44000000000000,3.61000000000000,6.44000000000000,9.81000000000000,18,39.1000000000000,74.3000000000000,119;1.09000000000000,1.36000000000000,2.61000000000000,4.50000000000000,6.74000000000000,12.2000000000000,18.9000000000000,35.7000000000000,80,158,257;1.51000000000000,1.89000000000000,3.63000000000000,6.30000000000000,9.46000000000000,17.3000000000000,26.9000000000000,51.8000000000000,120,240,395;1.79000000000000,2.23000000000000,4.28000000000000,7.41000000000000,11.2000000000000,20.3000000000000,31.8000000000000,61.3000000000000,143,291,NaN;2.14000000000000,2.66000000000000,5.09000000000000,8.82000000000000,13.2000000000000,24.1000000000000,37.5000000000000,NaN,NaN,NaN,NaN;2.56000000000000,3.19000000000000,6.11000000000000,10.5000000000000,15.8000000000000,28.7000000000000,44.4000000000000,NaN,NaN,NaN,NaN;2.77000000000000,3.44000000000000,6.59000000000000,11.4000000000000,17,30.7000000000000,47.6000000000000,NaN,NaN,NaN,NaN;2.96000000000000,3.67000000000000,7.01000000000000,12,18,NaN,NaN,NaN,NaN,NaN,NaN;3.13000000000000,3.89000000000000,7.44000000000000,12.8000000000000,19.1000000000000,NaN,NaN,NaN,NaN,NaN,NaN;3.29000000000000,4.08000000000000,7.80000000000000,13.4000000000000,20.1000000000000,NaN,NaN,NaN,NaN,NaN,NaN;NaN,4.40000000000000,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;];
    losspervol = lossperkg .* m19density; % (P / kg) * (kg / m^3) = P / m^3

    if dointerp
        
        % last row has too many nans
        losspervol = losspervol(1:end-1,:);
        tesla(end) = [];

        losspervolnonans = infillpower(freqs, losspervol);

        % add a row of zeros along the top
        losspervolnonans = [zeros(1, size(losspervolnonans, 2)); losspervolnonans];
        losspervolnonans = [zeros(size(losspervolnonans, 1), 1), losspervolnonans];

        % ensure row vectors
        freqs = freqs(:);
        tesla = tesla(:);

        % add zero values for freq and tesla
        freqs = [0; freqs];
        tesla = [0; tesla];

        % make a grid of interpolation points
        fi = linspace(min(freqs), max(freqs), 15); 
        Bi = linspace(min(tesla), max(tesla), 15);
        [fq,Bq] = meshgrid(fi,Bi);

        losspervollist = reshape(losspervolnonans, [], 1);

        Blist = repmat(tesla, numel(freqs), 1);

        freqlist = reshape(repmat(freqs(:)', [], numel(tesla)), [], 1);

        Pq = griddata(freqlist,Blist,losspervollist,fq,Bq);

        Pq(1,:) = 0;
        Pq(:,1) = 0;
    
    else
        
        [fq,Bq,Pq] = table2vectors(freqs,tesla,losspervol,true);
        
    end

end

