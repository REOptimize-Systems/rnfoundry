function [fq, Bq, Pq] = m45assheared29gagecorelossdata(dointerp)
% returns table of losses per kg in M-45 AS Sheared 29 Gage (0.014") Steel
% laminations at a number of frequencies and field strengths in Tesla
%
% Syntax
%
% [fq, Bq, Pq] = m36assheared26gagecorelossdata()
% [fq, Bq, Pq] = m36assheared26gagecorelossdata(dointerp)
%
% 

    if nargin < 1
        dointerp = true;
    end
    
    m36density = 7500; % kg / m^3
    freqs = [10,20,30,50,60,100,150,200,300,400,600,1000,1500,2000;];
    tesla = [0.100000000000000;0.200000000000000;0.400000000000000;0.700000000000000;1;1.20000000000000;1.30000000000000;1.40000000000000;1.50000000000000;1.55000000000000;1.60000000000000;1.65000000000000;1.70000000000000;];
    % loss data is provided in W/lb, convert to W/kg using conversion
    % factor of 2.2 lb/kg
    lossperkg = 2.2 * [0.00152000000000000,0.00320000000000000,0.00501000000000000,0.00893000000000000,0.0110600000000000,0.0207000000000000,0.0346000000000000,0.0508000000000000,0.0894000000000000,0.137000000000000,0.251000000000000;0.00632000000000000,0.0133000000000000,0.0210000000000000,0.0375000000000000,0.0466000000000000,0.0865000000000000,0.145000000000000,0.211000000000000,0.367000000000000,0.552000000000000,1;0.0213000000000000,0.0453000000000000,0.0714000000000000,0.130000000000000,0.161300000000000,0.305000000000000,0.517000000000000,0.760000000000000,1.33000000000000,2.01000000000000,3.64000000000000;0.0525000000000000,0.112000000000000,0.178000000000000,0.325000000000000,0.407000000000000,0.781000000000000,1.35000000000000,2,3.58000000000000,5.48000000000000,10.1000000000000;0.0937000000000000,0.200000000000000,0.318000000000000,0.584000000000000,0.733000000000000,1.42000000000000,2.48000000000000,3.74000000000000,6.81000000000000,10.7000000000000,20;0.129000000000000,0.275000000000000,0.437000000000000,0.804000000000000,1.00900000000000,1.96000000000000,3.45000000000000,5.23000000000000,9.65000000000000,15.2000000000000,29.3000000000000;0.150000000000000,0.321000000000000,0.510000000000000,0.938000000000000,1.17700000000000,2.29000000000000,4.01000000000000,6.10000000000000,11.3000000000000,17.9000000000000,34.6000000000000;0.176000000000000,0.376000000000000,0.598000000000000,1.09900000000000,1.37700000000000,2.67000000000000,4.69000000000000,7.12000000000000,13.2000000000000,20.9000000000000,40.7000000000000;0.209000000000000,0.445000000000000,0.707000000000000,1.29800000000000,1.62600000000000,3.15000000000000,5.50000000000000,8.36000000000000,15.5000000000000,24.4000000000000,NaN;0.227000000000000,0.484000000000000,0.768000000000000,1.40800000000000,1.76300000000000,3.42000000000000,5.97000000000000,9.04000000000000,16.7000000000000,29.4000000000000,NaN;0.246000000000000,0.524000000000000,0.830000000000000,1.52300000000000,1.90400000000000,3.69000000000000,6.45000000000000,9.73000000000000,17.9000000000000,28.4000000000000,NaN;0.292000000000000,0.559000000000000,0.886000000000000,1.62500000000000,2.03000000000000,3.93000000000000,6.86000000000000,10.4000000000000,NaN,NaN,NaN;0.278000000000000,0.589000000000000,0.933000000000000,1.70800000000000,2.13000000000000,4.13000000000000,7.24000000000000,10.9000000000000,NaN,NaN,NaN;];
    losspervol = lossperkg .* m36density; % (P / kg) * (kg / m^3) = P / m^3
    
    if dointerp

        lossperkgnonans = infillpower(freqs, losspervol);

        % add a row of zeros along the top
        losspervolnonans = [zeros(1, size(losspervolnonans, 2)); losspervolnonans];
        losspervolnonans = [zeros(size(losspervolnonans, 1), 1), losspervolnonans];

        % ensure row vectors
        freqs = freqs(:);
        tesla = tesla(:);

        % add zero values for freq and tesla
        freqs = [0; freqs];
        tesla = [0; tesla];

        % make a grid of interpolation points
        fi = linspace(min(freqs), max(freqs), 15); 
        Bi = linspace(min(tesla), max(tesla), 15);
        [fq,Bq] = meshgrid(fi,Bi);

        losspervollist = reshape(losspervolnonans, [], 1);

        Blist = repmat(tesla, numel(freqs), 1);

        freqlist = reshape(repmat(freqs(:)', [], numel(tesla)), [], 1);

        Pq = griddata(freqlist,Blist,losspervollist,fq,Bq);

        Pq(1,:) = 0;
        Pq(:,1) = 0;
    
    else
        
        [fq,Bq,Pq] = table2vectors(freqs,tesla,losspervol,true);
        
    end

end

