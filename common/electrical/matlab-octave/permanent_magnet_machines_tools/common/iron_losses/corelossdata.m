function [fq, Bq, Pq] = corelossdata(grade, gage, varargin)
% returns table of losses per kg for a variety of Steel
% laminations grades at a number of frequencies and field strengths in Tesla
%
% Syntax
%
% [fq, Bq, Pq] = corelossdata(grade, gage)
% [fq, Bq, Pq] = corelossdata(..., 'Parameter', Value)
%
% 

    Inputs.Processing = 'AsSheared';
    Inputs.InterpolateMissing = false;
    
    Inputs = parse_pv_pairs (Inputs, varargin);

    switch gage
    
      case '29'
      
          if strncmpi (Inputs.Processing, 'A', 1)
              lossperlb = getgage29assheared (grade);
          elseif strncmpi (Inputs.Processing, 'S', 1)
              lossperlb = getgage29SRA (grade);
          else
              error ('Unrecognised processing type.');
          end
          
      case '26'
      
          if strncmpi (Inputs.Processing, 'A', 1)
              lossperlb = getgage26assheared (grade);
          elseif strncmpi (Inputs.Processing, 'S', 1)
              lossperlb = getgage26SRA (grade);
          else
              error ('Unrecognised processing type.');
          end
          
      case '24'
    
          if strncmpi (Inputs.Processing, 'A', 1)
              lossperlb = getgage24assheared (grade);
          elseif strncmpi (Inputs.Processing, 'S', 1)
              lossperlb = getgage24SRA (grade);
          else
              error ('Unrecognised processing type.');
          end
          
      otherwise
      
          error ('Unrecognised gage');
          
    end
    
    lossperkg = lossperlb * 2.2;

    matdensity = 7700; % kg / m^3
    freqs = [10,20,30,50,60,100,150,200,300,400,600,1000,1500,2000;];
    tesla = [0.100000000000000;0.200000000000000;0.400000000000000;0.700000000000000;1;1.20000000000000;1.30000000000000;1.40000000000000;1.50000000000000;1.55000000000000;1.60000000000000;1.65000000000000;1.70000000000000;];

    losspervol = lossperkg .* matdensity; % (P / kg) * (kg / m^3) = P / m^3
    
    if Inputs.InterpolateMissing

        lossperkgnonans = infillpower(freqs, losspervol);

        % add a row of zeros along the top
        losspervolnonans = [zeros(1, size(losspervolnonans, 2)); losspervolnonans];
        losspervolnonans = [zeros(size(losspervolnonans, 1), 1), losspervolnonans];

        % ensure row vectors
        freqs = freqs(:);
        tesla = tesla(:);

        % add zero values for freq and tesla
        freqs = [0; freqs];
        tesla = [0; tesla];

        % make a grid of interpolation points
        fi = linspace(min(freqs), max(freqs), 15); 
        Bi = linspace(min(tesla), max(tesla), 15);
        [fq,Bq] = meshgrid(fi,Bi);

        losspervollist = reshape(losspervolnonans, [], 1);

        Blist = repmat(tesla, numel(freqs), 1);

        freqlist = reshape(repmat(freqs(:)', [], numel(tesla)), [], 1);

        Pq = griddata(freqlist,Blist,losspervollist,fq,Bq);

        Pq(1,:) = 0;
        Pq(:,1) = 0;
    
    else
        
        [fq,Bq,Pq] = table2vectors(freqs,tesla,losspervol,true);
        
    end

end


function lossperlb = getgage29assheared (grade)

    switch grade
    
        case 'M-19'
        
            lossperlb = [ 1.31700E-003 2.74000E-003 4.29000E-003 7.55000E-003 9.37000E-003 1.73000E-002 2.89000E-002 4.23000E-002 7.39000E-002 1.11900E-001 2.05000E-001 4.65000E-001 8.99500E-001 1.45100E+000;
                          5.41000E-003 1.12400E-002 1.76200E-002 3.14000E-002 3.87143E-002 7.16000E-002 1.18644E-001 1.73300E-001 3.00000E-001 4.51000E-001 8.12000E-001 1.78631E+000 3.37007E+000 5.31782E+000;
                          1.82700E-002 3.84000E-002 6.02000E-002 1.08500E-001 1.34400E-001 2.52000E-001 4.24000E-001 6.21000E-001 1.08500E+000 1.63500E+000 2.96000E+000 6.33969E+000 1.18345E+001 1.85234E+001;
                          4.50000E-002 9.53000E-002 1.50300E-001 2.73000E-001 3.40000E-001 6.47000E-001 1.10600E+000 1.64000E+000 2.92000E+000 4.45000E+000 8.18000E+000 1.77529E+001 3.37201E+001 5.39712E+001;
                          8.08000E-002 1.71400E-001 2.71000E-001 4.94000E-001 6.17000E-001 1.18200E+000 2.04000E+000 3.06000E+000 5.53000E+000 8.59000E+000 1.61800E+001 3.63028E+001 7.15292E+001 1.16702E+002;
                          1.12200E-001 2.38000E-001 3.76000E-001 6.87000E-001 8.58000E-001 1.64800E+000 2.86000E+000 4.29000E+000 7.83000E+000 1.22027E+001 2.35000E+001 5.42576E+001 1.08995E+002 1.79321E+002;
                          1.32900E-001 2.81000E-001 4.45000E-001 8.12000E-001 1.01400E+000 1.94200E+000 3.36000E+000 5.06000E+000 9.23000E+000 1.44095E+001 2.78099E+001 6.50999E+001 1.31918E+002 nan;
                          1.58500E-001 3.36000E-001 5.31000E-001 9.69000E-001 1.20900E+000 2.31000E+000 4.00000E+000 6.00000E+000 1.09200E+001 1.69999E+001 nan nan nan nan;
                          1.90600E-001 4.04000E-001 6.38000E-001 1.16100E+000 1.44700E+000 2.77000E+000 4.76000E+000 7.15000E+000 1.30000E+001 2.01442E+001 nan nan nan nan;
                          2.07000E-001 4.37000E-001 6.90000E-001 1.25600E+000 1.55900E+000 2.99000E+000 5.15000E+000 7.71000E+000 1.39422E+001 2.16189E+001 nan nan nan nan;
                          2.22000E-001 4.69000E-001 7.37795E-001 1.34229E+000 1.66685E+000 3.17881E+000 5.46634E+000 8.18945E+000 nan nan nan nan nan nan;
                          2.35000E-001 4.96418E-001 7.80764E-001 1.42018E+000 1.76279E+000 3.37462E+000 5.78759E+000 8.67443E+000 nan nan nan nan nan nan;
                          2.47796E-001 5.21208E-001 8.20318E-001 1.49204E+000 1.85172E+000 3.54041E+000 6.08860E+000 9.12899E+000 nan nan nan nan nan nan ];

        case 'M-36'
        
            lossperlb = [ 1.37600E-003 2.85000E-003 4.46000E-003 7.92000E-003 9.78000E-003 1.81400E-002 3.04000E-002 4.48000E-002 7.86000E-002 1.19900E-001 2.20000E-001 4.97500E-001 9.75000E-001 1.58950E+000;
                          6.28000E-003 1.30800E-002 2.02000E-002 3.58304E-002 4.42000E-002 8.10509E-002 1.34800E-001 1.95333E-001 3.38000E-001 5.03969E-001 9.10000E-001 1.97407E+000 3.75244E+000 5.93395E+000;
                          2.18000E-002 4.57000E-002 7.16000E-002 1.27900E-001 1.58600E-001 2.95000E-001 4.93000E-001 7.20000E-001 1.24900E+000 1.87500E+000 3.36000E+000 7.15644E+000 1.32705E+001 2.08041E+001;
                          5.39000E-002 1.13500E-001 1.78300E-001 3.22000E-001 4.01000E-001 7.57000E-001 1.28600E+000 1.89900E+000 3.35000E+000 5.11000E+000 9.32000E+000 2.01419E+001 3.84487E+001 6.17363E+001;
                          9.63000E-002 2.03000E-001 3.20000E-001 5.79000E-001 7.23000E-001 1.37600E+000 2.37000E+000 3.54000E+000 6.38000E+000 9.90000E+000 1.85700E+001 4.18586E+001 8.27478E+001 1.35380E+002;
                          1.33100E-001 2.81000E-001 4.41000E-001 8.01000E-001 9.99000E-001 1.90600E+000 3.30000E+000 4.96000E+000 9.06000E+000 1.41250E+001 2.72000E+001 6.27271E+001 1.29186E+002 2.07864E+002;
                          1.55400E-001 3.28000E-001 5.15000E-001 9.36000E-001 1.16600E+000 2.23000E+000 3.85000E+000 5.81000E+000 1.06400E+001 1.66809E+001 3.21715E+001 7.54132E+001 1.52730E+002 nan;
                          1.82900E-001 3.85000E-001 6.06000E-001 1.09800E+000 1.36900E+000 2.61000E+000 4.50000E+000 6.78000E+000 1.24300E+001 1.95298E+001 3.78281E+001 8.96195E+001 1.81690E+002 nan;
                          2.17000E-001 4.57000E-001 7.18000E-001 1.29700E+000 1.61900E+000 3.08000E+000 5.31000E+000 7.98000E+000 1.45800E+001 2.28282E+001 nan nan nan nan;
                          2.36000E-001 4.97000E-001 7.80000E-001 1.41100E+000 1.75300E+000 3.34000E+000 5.76000E+000 8.65000E+000 1.58300E+001 2.46911E+001 nan nan nan nan;
                          2.54000E-001 5.36000E-001 8.41000E-001 1.51800E+000 1.89200E+000 3.57900E+000 6.20000E+000 9.25376E+000 1.69130E+001 2.95424E+001 nan nan nan nan;
                          2.72000E-001 5.73000E-001 8.97000E-001 1.62000E+000 2.00524E+000 3.81720E+000 6.57912E+000 9.84104E+000 nan nan nan nan nan nan;
                          2.88000E-001 6.05302E-001 9.47386E-001 1.70710E+000 2.12402E+000 4.02399E+000 6.93887E+000 1.03821E+001 nan nan nan nan nan nan ];

        case 'M-45'
        
            lossperlb = [ 1.52300E-003 3.20000E-003 5.01000E-003 8.93000E-003 1.10600E-002 2.07000E-002 3.46000E-002 5.08000E-002 8.94000E-002 1.36700E-001 2.51000E-001 5.77000E-001 1.12300E+000 1.80900E+000;
                          6.32000E-003 1.33400E-002 2.10000E-002 3.75000E-002 4.65838E-002 8.65000E-002 1.45000E-001 2.11000E-001 3.67000E-001 5.52455E-001 1.00200E+000 2.21849E+000 4.19033E+000 6.60099E+000;
                          2.13000E-002 4.53000E-002 7.14000E-002 1.29600E-001 1.61300E-001 3.05000E-001 5.17000E-001 7.60000E-001 1.33300E+000 2.00712E+000 3.64000E+000 7.83311E+000 1.45859E+001 2.26920E+001;
                          5.25000E-002 1.12000E-001 1.77500E-001 3.25000E-001 4.07000E-001 7.81000E-001 1.34500E+000 2.00000E+000 3.58000E+000 5.48000E+000 1.00700E+001 2.19315E+001 4.19124E+001 6.71351E+001;
                          9.37000E-002 2.00000E-001 3.18000E-001 5.84000E-001 7.33000E-001 1.42200E+000 2.48000E+000 3.74000E+000 6.81000E+000 1.06600E+001 2.00000E+001 4.52548E+001 8.94252E+001 1.45302E+002;
                          1.28700E-001 2.75000E-001 4.37000E-001 8.04000E-001 1.00900E+000 1.96400E+000 3.45000E+000 5.23000E+000 9.65000E+000 1.51730E+001 2.93000E+001 6.77841E+001 1.36087E+002 2.21486E+002;
                          1.50200E-001 3.21000E-001 5.10000E-001 9.38000E-001 1.17700E+000 2.29000E+000 4.01000E+000 6.10000E+000 1.13100E+001 1.78711E+001 3.46463E+001 8.14799E+001 1.64297E+002 nan;
                          1.76300E-001 3.76000E-001 5.98000E-001 1.09900E+000 1.37700E+000 2.67000E+000 4.69000E+000 7.12000E+000 1.32100E+001 2.08736E+001 4.06853E+001 9.66682E+001 1.95132E+002 nan;
                          2.09000E-001 4.45000E-001 7.07000E-001 1.29800E+000 1.62600E+000 3.15000E+000 5.50000E+000 8.36000E+000 1.54500E+001 2.43988E+001 nan nan nan nan;
                          2.27000E-001 4.84000E-001 7.68000E-001 1.40800E+000 1.76300E+000 3.42000E+000 5.97000E+000 9.04000E+000 1.67100E+001 2.93771E+001 nan nan nan nan;
                          2.46000E-001 5.24000E-001 8.30000E-001 1.52300E+000 1.90400E+000 3.69000E+000 6.45000E+000 9.72807E+000 1.79475E+001 2.84109E+001 nan nan nan nan;
                          2.92000E-001 5.59000E-001 8.86000E-001 1.62500E+000 2.03000E+000 3.92529E+000 6.85851E+000 1.03684E+001 nan nan nan nan nan nan;
                          2.78000E-001 5.89248E-001 9.33426E-001 1.70848E+000 2.13436E+000 4.13159E+000 7.24055E+000 1.09162E+001 nan nan nan nan nan nan ];


        otherwise
        
            error ('Unrecognised grade/no data for grade and gage combination');
        
    end
end



function lossperlb = getgage29SRA (grade)

    switch grade
    
        case 'M-19'
        
            lossperlb = [ 1.43300E-003 2.95000E-003 4.57000E-003 8.03000E-003 9.88000E-003 1.79800E-002 2.96000E-002 4.30000E-002 7.40000E-002 1.11100E-001 2.01000E-001 4.49305E-001 8.71000E-001 1.38172E+000;
                          5.20000E-003 1.08000E-002 1.67800E-002 2.97431E-002 3.66000E-002 6.70949E-002 1.11379E-001 1.61295E-001 2.79493E-001 4.16389E-001 7.50953E-001 1.66714E+000 3.14960E+000 4.95690E+000;
                          1.72400E-002 3.61000E-002 5.64000E-002 1.01200E-001 1.25400E-001 2.34000E-001 3.92000E-001 5.74000E-001 1.00100E+000 1.50800E+000 2.72000E+000 5.86143E+000 1.09605E+001 1.70952E+001;
                          4.27000E-002 8.99000E-002 1.41400E-001 2.56000E-001 3.19000E-001 6.05000E-001 1.03200E+000 1.52800E+000 2.71000E+000 4.13000E+000 7.56000E+000 1.63793E+001 3.11801E+001 4.98702E+001;
                          7.68000E-002 1.62500E-001 2.56000E-001 4.67000E-001 5.82000E-001 1.11400E+000 1.92200E+000 2.88000E+000 5.20000E+000 8.04000E+000 1.50900E+001 3.37478E+001 6.68451E+001 1.09688E+002;
                          1.07200E-001 2.27000E-001 3.58000E-001 6.52000E-001 8.14000E-001 1.55900E+000 2.70000E+000 4.06000E+000 7.42000E+000 1.16100E+001 2.22000E+001 5.09874E+001 1.02862E+002 1.71331E+002;
                          1.27100E-001 2.99000E-001 4.25000E-001 7.72000E-001 9.64000E-001 1.84300E+000 3.19000E+000 4.80000E+000 8.77000E+000 1.37042E+001 2.93817E+001 6.17581E+001 1.25615E+002 nan;
                          1.53600E-001 3.24000E-001 5.11000E-001 9.28000E-001 1.15700E+000 2.21000E+000 3.81000E+000 5.71000E+000 1.04200E+001 1.62418E+001 nan nan nan nan;
                          1.88400E-001 3.97000E-001 6.25000E-001 1.13200E+000 1.40700E+000 2.68000E+000 4.59000E+000 6.87000E+000 1.24186E+001 1.93942E+001 nan nan nan nan;
                          2.06000E-001 4.33000E-001 6.81000E-001 1.23400E+000 1.53100E+000 2.91000E+000 5.00000E+000 7.47000E+000 1.34867E+001 2.09452E+001 nan nan nan nan;
                          2.21000E-001 4.64533E-001 7.29995E-001 1.32184E+000 1.63454E+000 3.11808E+000 5.31486E+000 7.93659E+000 nan nan nan nan nan nan;
                          2.34861E-001 4.93459E-001 7.71712E-001 1.40110E+000 1.72967E+000 3.29411E+000 5.62942E+000 8.42934E+000 nan nan nan nan nan nan;
                          2.46829E-001 5.18202E-001 8.11158E-001 1.47235E+000 1.81621E+000 3.46129E+000 5.92041E+000 8.86685E+000 nan nan nan nan nan nan ];


        case 'M-36'
        
            lossperlb = [ 1.55000E-003 3.20000E-003 4.96000E-003 8.70000E-003 1.07300E-002 1.96900E-002 3.29000E-002 4.74000E-002 8.21000E-002 1.23900E-001 2.25000E-001 5.00000E-001 9.61500E-001 1.55550E+000;
                          6.21000E-003 1.28500E-002 1.98300E-002 3.51340E-002 4.33000E-002 7.90598E-002 1.30400E-001 1.88762E-001 3.24178E-001 4.83094E-001 8.69000E-001 1.88533E+000 3.54299E+000 5.57110E+000;
                          2.09000E-002 4.39000E-002 6.86000E-002 1.22900E-001 1.52400E-001 2.83000E-001 4.72000E-001 6.85000E-001 1.18300E+000 1.76800E+000 3.15000E+000 6.65508E+000 1.22948E+001 1.92032E+001;
                          5.12000E-002 1.07900E-001 1.69800E-001 3.07000E-001 3.83000E-001 7.24000E-001 1.22800E+000 1.81100E+000 3.18000E+000 4.82000E+000 8.73000E+000 1.86924E+001 3.53318E+001 5.68669E+001;
                          9.16000E-002 1.93500E-001 3.04000E-001 5.53000E-001 6.90000E-001 1.31500E+000 2.29000E+000 3.38000E+000 6.07000E+000 9.39000E+000 1.75200E+001 3.91531E+001 7.70571E+001 1.29112E+002;
                          1.29800E-001 2.98000E-001 4.21000E-001 7.65000E-001 9.53000E-001 1.82200E+000 3.15000E+000 4.74000E+000 8.66000E+000 1.34988E+001 2.59000E+001 5.94726E+001 1.19349E+002 1.96600E+002;
                          1.48500E-001 3.13000E-001 4.94000E-001 8.95000E-001 1.11700E+000 2.13000E+000 3.69000E+000 5.56000E+000 1.02000E+001 1.59966E+001 3.10000E+001 7.21519E+001 1.45580E+002 nan;
                          1.75900E-001 3.71000E-001 5.84000E-001 1.05700E+000 1.31600E+000 2.51000E+000 4.33000E+000 6.52000E+000 1.19800E+001 1.88661E+001 3.67853E+001 8.68744E+001 1.75668E+002 nan;
                          2.12000E-001 4.47000E-001 7.02000E-001 1.29600E+000 1.57400E+000 2.99000E+000 5.15000E+000 7.73000E+000 1.41900E+001 2.22599E+001 nan nan nan nan;
                          2.34000E-001 4.91000E-001 7.70000E-001 1.39100E+000 1.72300E+000 3.28000E+000 5.63000E+000 8.40667E+000 1.53708E+001 2.42389E+001 nan nan nan nan;
                          2.54000E-001 5.33000E-001 8.37000E-001 1.50417E+000 1.86606E+000 3.53790E+000 6.06385E+000 9.07459E+000 1.65917E+001 2.91800E+001 nan nan nan nan;
                          2.73000E-001 5.72000E-001 8.93727E-001 1.60634E+000 1.99238E+000 3.77469E+000 6.46693E+000 9.66662E+000 nan nan nan nan nan nan;
                          2.88822E-001 6.05312E-001 9.45257E-001 1.69712E+000 2.10371E+000 3.98005E+000 6.84980E+000 1.02077E+001 nan nan nan nan nan nan ];


        case 'M-45'
        
            lossperlb = [ 1.36100E-003 2.84000E-003 4.46000E-003 7.96000E-003 9.89000E-003 1.85000E-002 3.12000E-002 4.62000E-002 8.20000E-002 1.25000E-001 2.33000E-001 5.46000E-001 1.06650E+000 1.70550E+000;
                          5.50000E-003 1.15500E-002 1.80400E-002 3.23236E-002 4.01000E-002 7.45348E-002 1.24858E-001 1.83994E-001 3.22018E-001 4.87821E-001 8.91753E-001 2.01974E+000 3.85141E+000 5.98125E+000;
                          1.86600E-002 3.96000E-002 6.29000E-002 1.13700E-001 1.41500E-001 2.97000E-001 4.54000E-001 6.68000E-001 1.17900E+000 1.77800E+000 3.24000E+000 6.97606E+000 1.29942E+001 2.00973E+001;
                          4.58000E-002 9.81000E-002 1.56100E-001 2.88000E-001 3.60000E-001 6.96000E-001 1.20100E+000 1.79100E+000 3.19000E+000 4.87000E+000 8.96000E+000 1.93666E+001 3.68962E+001 5.89506E+001;
                          8.15000E-002 1.74900E-001 2.79000E-001 5.18000E-001 6.51000E-001 1.27300E+000 2.23000E+000 3.37000E+000 6.14000E+000 9.53000E+000 1.80000E+001 4.05455E+001 8.08896E+001 1.31311E+002;
                          1.12100E-001 2.41000E-001 3.84000E-001 7.13000E-001 8.97000E-001 1.76100E+000 3.11000E+000 4.74000E+000 8.78000E+000 1.38100E+001 2.97000E+001 6.21224E+001 1.29383E+002 2.06815E+002;
                          1.31100E-001 2.81000E-001 4.49000E-001 8.32000E-001 1.04800E+000 2.06000E+000 3.64000E+000 5.55000E+000 1.03600E+001 1.64500E+001 3.22000E+001 7.57910E+001 1.54845E+002 nan;
                          1.55300E-001 3.33000E-001 5.30000E-001 9.81000E-001 1.23300E+000 2.41000E+000 4.29000E+000 6.51000E+000 1.22200E+001 1.93615E+001 3.83315E+001 9.16609E+001 1.87310E+002 nan;
                          1.88100E-001 4.02000E-001 6.39000E-001 1.17700E+000 1.47600E+000 2.88000E+000 5.06000E+000 7.71000E+000 1.44400E+001 2.30358E+001 nan nan nan nan;
                          2.07000E-001 4.43000E-001 7.04000E-001 1.29500E+000 1.62400E+000 3.16000E+000 5.54000E+000 8.43000E+000 1.57300E+001 2.50251E+001 nan nan nan nan;
                          2.29000E-001 4.83000E-001 7.66000E-001 1.40900E+000 1.76500E+000 3.43000E+000 6.02000E+000 9.09521E+000 1.69892E+001 2.72031E+001 nan nan nan nan;
                          2.44000E-001 5.19000E-001 8.23000E-001 1.50811E+000 1.89200E+000 3.66577E+000 6.41960E+000 9.73848E+000 nan nan nan nan nan nan;
                          2.58000E-001 5.47272E-001 8.68129E-001 1.59169E+000 1.99129E+000 3.86059E+000 6.76849E+000 1.02765E+001 nan nan nan nan nan nan ];

        otherwise
        
            error ('Unrecognised grade/no data for grade and gage combination');
        
    end
end


function lossperlb = getgage26assheared (grade)

    switch grade
    
        case 'M-19'
        
            lossperlb = [ 1.26400E-003 2.71000E-003 4.31000E-003 7.95000E-003 9.99000E-003 1.94400E-002 3.38000E-002 5.09000E-002 9.28000E-002 1.43900E-001 2.83000E-001 6.44500E-001 1.25300E+000 2.00000E+000;
            4.97000E-003 1.07197E-002 1.71600E-002 3.17000E-002 3.98000E-002 7.68546E-002 1.34100E-001 2.00000E-001 3.61000E-001 5.51132E-001 1.06200E+000 2.34618E+000 4.44932E+000 6.95621E+000;
            1.65500E-002 3.61000E-002 5.82000E-002 1.09100E-001 1.37900E-001 2.70000E-001 4.74000E-001 7.13000E-001 1.29100E+000 1.98400E+000 3.73000E+000 8.13912E+000 1.54171E+001 2.43100E+001;
            4.04000E-002 8.92000E-002 1.45300E-001 2.77000E-001 3.53000E-001 7.08000E-001 1.26200E+000 1.92500E+000 3.55000E+000 5.52000E+000 1.04900E+001 2.35753E+001 4.61086E+001 7.48465E+001;
            7.19000E-002 1.59600E-001 2.61000E-001 5.03000E-001 6.42000E-001 1.31100E+000 2.38000E+000 3.69000E+000 6.96000E+000 1.10600E+001 2.15000E+001 5.11500E+001 1.02974E+002 1.69512E+002;
            9.95000E-002 2.21000E-001 3.62000E-001 6.99000E-001 8.93000E-001 1.83200E+000 3.36000E+000 5.24000E+000 1.00500E+001 1.62200E+001 3.22000E+001 7.78733E+001 1.61600E+002 2.65403E+002;
            1.16900E-001 2.60000E-001 4.27000E-001 8.22000E-001 1.05100E+000 2.16000E+000 3.95000E+000 6.18000E+000 1.19100E+001 1.92247E+001 3.89000E+001 9.47093E+001 1.96290E+002 nan;
            1.40100E-001 3.10000E-001 5.09000E-001 9.78000E-001 1.25000E+000 2.56000E+000 4.67000E+000 7.30000E+000 1.40800E+001 2.27872E+001 nan nan nan nan;
            1.68200E-001 3.73000E-001 6.09000E-001 1.16900E+000 1.48800E+000 3.04000E+000 5.55000E+000 8.65000E+000 1.66300E+001 2.68237E+001 nan nan nan nan;
            1.82700E-001 4.04000E-001 6.61000E-001 1.26700E+000 1.61300E+000 3.30000E+000 6.01000E+000 9.31800E+000 1.79070E+001 2.90017E+001 nan nan nan nan;
            1.95900E-001 4.34000E-001 7.10000E-001 1.36000E+000 1.73000E+000 3.54000E+000 6.41649E+000 9.95866E+000 nan nan nan nan nan nan;
            2.09000E-001 4.61000E-001 7.53023E-001 1.43795E+000 1.83104E+000 3.72967E+000 6.79695E+000 1.05671E+001 nan nan nan nan nan nan;
            2.19000E-001 4.84028E-001 7.92755E-001 1.51269E+000 1.92532E+000 3.92507E+000 7.16711E+000 1.11322E+001 nan nan nan nan nan nan ];

        case 'M-36'
        
            lossperlb = [ 1.42000E-003 3.01000E-003 4.74000E-003 8.68000E-003 1.08400E-002 2.07000E-002 3.60000E-002 5.43000E-002 9.87000E-002 1.52500E-001 3.00000E-001 6.85000E-001 1.39900E+000 2.15000E+000;
            6.16000E-003 1.30300E-002 2.05000E-002 3.71910E-002 4.65000E-002 8.83000E-002 1.50317E-001 2.24030E-001 3.99333E-001 6.13000E-001 1.17200E+000 2.54459E+000 4.87627E+000 7.55360E+000;
            2.09000E-002 4.48000E-002 7.12000E-002 1.30700E-001 1.63700E-001 3.15000E-001 5.43000E-001 8.12000E-001 1.45400E+000 2.22000E+000 4.15000E+000 8.93330E+000 1.68950E+001 2.65582E+001;
            5.10000E-002 1.10300E-001 1.77200E-001 3.31000E-001 4.18000E-001 8.21000E-001 1.44200E+000 2.19000E+000 3.99000E+000 6.20000E+000 1.17400E+001 2.63759E+001 5.18071E+001 8.41996E+001;
            9.00000E-002 1.95800E-001 3.16000E-001 5.97000E-001 7.58000E-001 1.52100E+000 2.73000E+000 4.21000E+000 7.90000E+000 1.25000E+001 2.44000E+001 5.75422E+001 1.18200E+002 1.92376E+002;
            1.23100E-001 2.68000E-001 4.33000E-001 8.21000E-001 1.04400E+000 2.11000E+000 3.85000E+000 6.00000E+000 1.14800E+001 1.84500E+001 3.67000E+001 8.91000E+001 1.83950E+002 2.99080E+002;
            1.43600E-001 3.13000E-001 5.05000E-001 9.56000E-001 1.21600E+000 2.47000E+000 4.50000E+000 7.05000E+000 1.35700E+001 2.20000E+001 4.43000E+001 1.08550E+002 2.24000E+002 nan;
            1.67900E-001 3.66000E-001 5.91000E-001 1.11900E+000 1.42300E+000 2.88000E+000 5.25000E+000 8.23000E+000 1.58800E+001 2.56904E+001 5.20565E+001 1.28762E+002 2.65688E+002 nan;
            1.98700E-001 4.32000E-001 6.98000E-001 1.32000E+000 1.67600E+000 3.39000E+000 6.15000E+000 9.64000E+000 1.85500E+001 3.00638E+001 nan nan nan nan;
            2.15000E-001 4.68000E-001 7.57000E-001 1.43000E+000 1.81600E+000 3.67000E+000 6.66000E+000 1.04300E+001 2.01000E+001 3.24673E+001 nan nan nan nan;
            2.32000E-001 5.05000E-001 8.15000E-001 1.53900E+000 1.94900E+000 3.94000E+000 7.16000E+000 1.11656E+001 2.14567E+001 3.49442E+001 nan nan nan nan;
            2.48000E-001 5.38000E-001 8.68000E-001 1.63700E+000 2.07000E+000 4.19000E+000 7.62000E+000 1.18577E+001 nan nan nan nan nan nan;
            2.60000E-001 5.65000E-001 9.11989E-001 1.72106E+000 2.18250E+000 4.40761E+000 8.00600E+000 1.25241E+001 nan nan nan nan nan nan ];

        otherwise
        
            error ('Unrecognised grade/no data for grade and gage combination');
        
    end
end



function lossperlb = getgage26SRA (grade)

    switch grade
    
        case 'M-19'
        
            lossperlb = [ 1.26400E-003 2.67000E-003 4.21000E-003 7.69000E-003 9.59000E-003 1.84300E-002 3.18000E-002 4.77000E-002 8.63000E-002 1.32900E-001 2.63000E-001 5.91500E-001 1.15100E+000 1.83050E+000;
            4.53542E-003 9.67278E-003 1.53700E-002 2.82124E-002 3.52808E-002 6.83000E-002 1.18077E-001 1.77800E-001 3.19883E-001 5.03000E-001 9.54924E-001 2.10854E+000 4.02185E+000 6.30296E+000;
            1.48800E-002 3.23000E-002 5.21000E-002 9.73000E-002 1.22500E-001 2.41000E-001 4.21000E-001 6.35000E-001 1.15100E+000 1.78100E+000 3.37000E+000 7.26630E+000 1.38167E+001 2.17004E+001;
            3.70000E-002 8.13000E-002 1.32100E-001 2.52000E-001 3.19000E-001 6.40000E-001 1.14100E+000 1.73900E+000 3.20000E+000 4.95000E+000 9.53000E+000 2.11688E+001 4.16130E+001 6.76197E+001;
            6.67000E-002 1.47500E-001 2.41000E-001 4.63000E-001 5.91000E-001 1.20400E+000 2.19000E+000 3.38000E+000 6.38000E+000 1.00300E+001 1.98800E+001 4.64151E+001 9.52648E+001 1.56401E+002;
            9.32000E-002 2.06000E-001 3.37000E-001 6.48000E-001 8.28000E-001 1.69700E+000 3.11000E+000 4.86000E+000 9.33000E+000 1.49100E+001 3.02000E+001 7.29500E+001 1.52350E+002 2.49252E+002;
            1.10500E-001 2.44000E-001 3.98000E-001 7.64000E-001 9.75000E-001 2.00000E+000 3.68000E+000 5.76000E+000 1.11400E+001 1.79700E+001 3.67000E+001 8.91928E+001 1.88050E+002 nan;
            1.32800E-001 2.93000E-001 4.77000E-001 9.15000E-001 1.16500E+000 2.38000E+000 4.37000E+000 6.84000E+000 1.32900E+001 2.14495E+001 nan nan nan nan;
            1.63500E-001 3.59000E-001 5.83000E-001 1.11100E+000 1.41300E+000 2.87000E+000 5.24000E+000 8.20000E+000 1.58600E+001 2.52067E+001 nan nan nan nan;
            1.78600E-001 3.92000E-001 6.37000E-001 1.21400E+000 1.54000E+000 3.13000E+000 5.70000E+000 8.86010E+000 1.71330E+001 2.74315E+001 nan nan nan nan;
            1.91900E-001 4.22000E-001 6.87000E-001 1.30196E+000 1.65142E+000 3.34319E+000 6.09382E+000 9.50388E+000 nan nan nan nan nan nan;
            2.05000E-001 4.49000E-001 7.31000E-001 1.38080E+000 1.75182E+000 3.55075E+000 6.46861E+000 1.00803E+001 nan nan nan nan nan nan;
            2.14771E-001 4.71013E-001 7.66725E-001 1.45462E+000 1.84393E+000 3.74634E+000 6.82908E+000 1.06411E+001 nan nan nan nan nan nan ];

        case 'M-36'
        
            lossperlb = [ 1.55700E-003 3.28000E-003 5.13000E-003 9.25000E-003 1.14700E-002 2.17000E-002 3.70000E-002 5.49000E-002 9.84000E-002 1.51600E-001 2.92000E-001 6.56500E-001 1.25791E+000 2.00828E+000;
            5.83504E-003 1.23400E-002 1.93805E-002 3.50996E-002 4.35612E-002 8.26437E-002 1.41100E-001 2.07800E-001 3.72000E-001 5.66028E-001 1.07900E+000 2.35114E+000 4.38942E+000 6.90398E+000;
            1.95000E-002 4.17000E-002 6.62000E-002 1.21500E-001 1.52000E-001 2.92000E-001 5.02000E-001 7.47000E-001 1.33200E+000 2.04000E+000 3.79000E+000 8.06764E+000 1.51145E+001 2.38255E+001;
            4.78000E-002 1.03300E-001 1.65700E-001 3.09000E-001 3.90000E-001 7.65000E-001 1.34100E+000 2.02000E+000 3.67000E+000 5.69000E+000 1.06700E+001 2.37360E+001 4.66345E+001 7.63802E+001;
            8.48000E-002 1.84300E-001 2.97000E-001 5.61000E-001 7.11000E-001 1.42500E+000 2.55000E+000 3.91000E+000 7.31000E+000 1.16100E+001 2.25000E+001 5.31879E+001 1.08740E+002 1.78836E+002;
            1.16300E-001 2.53000E-001 4.09000E-001 7.75000E-001 9.84000E-001 1.99300E+000 3.62000E+000 5.62000E+000 1.07200E+001 1.73100E+001 3.44000E+001 8.39000E+001 1.73650E+002 2.82893E+002;
            1.35800E-001 2.95000E-001 4.77000E-001 9.04000E-001 1.14800E+000 2.33000E+000 4.25000E+000 6.64000E+000 1.28000E+001 2.09000E+001 4.19000E+001 1.02950E+002 2.12500E+002 nan;
            1.59800E-001 3.47000E-001 5.61000E-001 1.05900E+000 1.34700E+000 2.73000E+000 4.99000E+000 7.81000E+000 1.51700E+001 2.48010E+001 4.99194E+001 1.24436E+002 2.57435E+002 nan;
            1.91400E-001 4.16000E-001 6.69000E-001 1.26100E+000 1.59900E+000 3.23000E+000 5.88000E+000 9.20000E+000 1.78800E+001 2.94081E+001 nan nan nan nan;
            2.10000E-001 4.54000E-001 7.30000E-001 1.37700E+000 1.73900E+000 3.51000E+000 6.38000E+000 1.00000E+001 1.93700E+001 3.18389E+001 nan nan nan nan;
            2.26000E-001 4.91000E-001 7.90000E-001 1.48500E+000 1.87900E+000 3.77373E+000 6.89000E+000 1.07181E+001 2.06591E+001 3.44179E+001 nan nan nan nan;
            2.42000E-001 5.23000E-001 8.42000E-001 1.57807E+000 1.99307E+000 4.02108E+000 7.34000E+000 1.13961E+001 nan nan nan nan nan nan;
            2.54000E-001 5.50000E-001 8.84878E-001 1.66184E+000 2.10212E+000 4.23634E+000 7.71818E+000 1.20388E+001 nan nan nan nan nan nan ];

        otherwise
        
            error ('Unrecognised grade/no data for grade and gage combination');
        
    end
end

function lossperlb = getgage24assheared (grade)

    switch grade
    
        case 'M-19'
        
            lossperlb = [ 1.49200E-003 3.24000E-003 5.22000E-003 9.86000E-003 1.25200E-002 2.50000E-002 4.47000E-002 6.88000E-002 1.28767E-001 2.03233E-001 3.92000E-001 8.98667E-001 1.70920E+000 2.69374E+000;
            5.77000E-003 1.27100E-002 2.06000E-002 3.89000E-002 4.92000E-002 9.77000E-002 1.74000E-001 2.65000E-001 4.88333E-001 7.59000E-001 1.42477E+000 3.14779E+000 5.93424E+000 9.24054E+000;
            1.89300E-002 4.23000E-002 6.94000E-002 1.33600E-001 1.70100E-001 3.43000E-001 6.13000E-001 9.34000E-001 1.73067E+000 2.68000E+000 5.02071E+000 1.11943E+001 2.13603E+001 3.40024E+001;
            4.61000E-002 1.04600E-001 1.74100E-001 3.42000E-001 4.40000E-001 9.12000E-001 1.66700E+000 2.58000E+000 4.92333E+000 7.77667E+000 1.49905E+001 3.51342E+001 7.03810E+001 1.16164E+002;
            8.14000E-002 1.86700E-001 3.13000E-001 6.28000E-001 8.14000E-001 1.73700E+000 3.26000E+000 5.17000E+000 1.01800E+001 1.64733E+001 3.29405E+001 8.16333E+001 1.67747E+002 2.79477E+002;
            1.11800E-001 2.57000E-001 4.33000E-001 8.72000E-001 1.13200E+000 2.45000E+000 4.67000E+000 7.52000E+000 1.51867E+001 2.50667E+001 5.13333E+001 1.28933E+002 2.68351E+002 nan;
            1.31100E-001 3.01000E-001 5.07000E-001 1.02300E+000 1.32800E+000 2.88000E+000 5.52000E+000 8.91000E+000 1.82133E+001 3.03000E+001 6.19474E+001 1.58300E+002 3.28453E+002 nan;
            1.55400E-001 3.57000E-001 6.01000E-001 1.20800E+000 1.56900E+000 3.39000E+000 6.49000E+000 1.05100E+001 2.13627E+001 3.55938E+001 7.44651E+001 1.89337E+002 3.93999E+002 nan;
            1.85800E-001 4.26000E-001 7.14000E-001 1.43000E+000 1.85600E+000 4.00000E+000 7.65000E+000 1.23500E+001 2.45914E+001 nan nan nan nan nan;
            2.01000E-001 4.62000E-001 7.73000E-001 1.54700E+000 2.00000E+000 4.33000E+000 8.28000E+000 1.33500E+001 2.60367E+001 nan nan nan nan nan;
            2.18000E-001 4.97000E-001 8.31000E-001 1.66200E+000 2.16000E+000 4.65000E+000 8.88000E+000 1.43200E+001 nan nan nan nan nan nan;
            2.32000E-001 5.30000E-001 8.89000E-001 1.77300E+000 2.30000E+000 4.95000E+000 9.45000E+000 1.52500E+001 nan nan nan nan nan nan;
            2.46000E-001 5.60000E-001 9.39000E-001 1.87600E+000 2.43000E+000 5.24000E+000 1.00100E+001 1.61600E+001 nan nan nan nan nan nan ];

        otherwise
        
            error ('Unrecognised grade/no data for grade and gage combination');
        
    end
end

function lossperlb = getgage24SRA (grade)

    error ('Unrecognised grade/no data for grade and gage combination');

end