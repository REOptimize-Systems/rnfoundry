function [fq, Bq, Pq] = m47assheared24gagecorelossdata(dointerp)
% returns table of losses per kg in M-47 AS Sheared 24 Gage (0.025") Steel
% laminations at a number of frequencies and field strengths in Tesla
%
% Using data on Specific Core Loss (W/lb) of As-Sheared 24 Gage M47 Fully
% Processed CRNO at Various Frequencies from AK Steel. Data is converted to
% W/kg using a factor of 2.2.
%
% Syntax
%
% [fq, Bq, Pq] = m36assheared26gagecorelossdata()
% [fq, Bq, Pq] = m36assheared26gagecorelossdata(dointerp)
%
% 

    if nargin < 1
        dointerp = true;
    end
    
    m36density = 7500; % kg / m^3
    freqs = [10,20,30,50,60,100,150,200,300,400,600,1000,1500,2000;];
    tesla = [0.100000000000000;0.200000000000000;0.400000000000000;0.700000000000000;1;1.20000000000000;1.30000000000000;1.40000000000000;1.50000000000000;1.55000000000000;1.60000000000000;1.65000000000000;1.70000000000000;];
    % loss data is provided in W/lb, convert to W/kg using conversion
    % factor of 2.2 lb/kg
    lossperkg = 2.2 * [0.00176000000000000,0.00379000000000000,0.00607000000000000,0.0115000000000000,0.0146000000000000,0.0292000000000000,0.0527000000000000,0.0813000000000000,0.154000000000000,0.244000000000000,0.472000000000000;0.00752000000000000,0.0163000000000000,0.0262000000000000,0.0490000000000000,0.0619000000000000,0.122000000000000,0.216000000000000,0.327000000000000,0.605000000000000,0.934000000000000,1.72000000000000;0.0254000000000000,0.0560000000000000,0.0910000000000000,0.173000000000000,0.220000000000000,0.436000000000000,0.772000000000000,1.16000000000000,2.14000000000000,3.30000000000000,6.02000000000000;0.0620000000000000,0.139000000000000,0.229000000000000,0.444000000000000,0.569000000000000,1.16000000000000,2.10000000000000,3.22000000000000,6.11000000000000,9.58000000000000,18.2000000000000;0.110000000000000,0.247000000000000,0.412000000000000,0.815000000000000,1.05000000000000,2.21000000000000,4.12000000000000,6.48000000000000,12.7000000000000,20.6000000000000,40.8000000000000;0.150000000000000,0.339000000000000,0.565000000000000,1.13000000000000,1.46000000000000,3.14000000000000,5.95000000000000,9.52000000000000,19.2000000000000,31.4000000000000,63.7000000000000;0.173000000000000,0.392000000000000,0.655000000000000,1.31000000000000,1.70000000000000,3.67000000000000,7.02000000000000,11.3000000000000,23.1000000000000,38.2000000000000,77.5000000000000;0.201000000000000,0.455000000000000,0.759000000000000,1.52000000000000,1.97000000000000,4.26000000000000,8.20000000000000,13.3000000000000,27.4000000000000,45.9000000000000,92.6000000000000;0.235000000000000,0.531000000000000,0.886000000000000,1.77000000000000,2.28000000000000,4.93000000000000,9.51000000000000,15.4000000000000,31.5000000000000,52.8000000000000,109;0.254000000000000,0.574000000000000,0.956000000000000,1.91000000000000,2.47000000000000,5.32000000000000,10.2000000000000,16.6000000000000,33.6000000000000,56.4000000000000,118;0.273000000000000,0.616000000000000,1.03000000000000,2.04000000000000,2.65000000000000,5.71000000000000,11,17.8000000000000,35.5000000000000,NaN,NaN;0.291000000000000,0.657000000000000,1.10000000000000,2.18000000000000,2.83000000000000,6.11000000000000,11.7000000000000,19,NaN,NaN,NaN;0.307000000000000,0.695000000000000,1.16000000000000,2.31000000000000,3,6.48000000000000,12.4000000000000,20.2000000000000,NaN,NaN,NaN;];
    losspervol = lossperkg .* m36density; % (P / kg) * (kg / m^3) = P / m^3
    
    if dointerp

        lossperkgnonans = infillpower(freqs, losspervol);

        % add a row of zeros along the top
        losspervolnonans = [zeros(1, size(losspervolnonans, 2)); losspervolnonans];
        losspervolnonans = [zeros(size(losspervolnonans, 1), 1), losspervolnonans];

        % ensure row vectors
        freqs = freqs(:);
        tesla = tesla(:);

        % add zero values for freq and tesla
        freqs = [0; freqs];
        tesla = [0; tesla];

        % make a grid of interpolation points
        fi = linspace(min(freqs), max(freqs), 15); 
        Bi = linspace(min(tesla), max(tesla), 15);
        [fq,Bq] = meshgrid(fi,Bi);

        losspervollist = reshape(losspervolnonans, [], 1);

        Blist = repmat(tesla, numel(freqs), 1);

        freqlist = reshape(repmat(freqs(:)', [], numel(tesla)), [], 1);

        Pq = griddata(freqlist,Blist,losspervollist,fq,Bq);

        Pq(1,:) = 0;
        Pq(:,1) = 0;
    
    else
        
        [fq,Bq,Pq] = table2vectors(freqs,tesla,losspervol,true);
        
    end

end

